<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Lesson 18 - Full Writing Test Simulation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .nav-button {
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 10px 25px;
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.3s;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .nav-button:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
        }

        .section h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 15px 30px;
            background: #f0f0f0;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
            transition: all 0.3s;
        }

        .tab:hover {
            background: #e0e0e0;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .info-box {
            background: #e8eaf6;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #667eea;
            margin: 20px 0;
            line-height: 1.6;
        }

        .warning-box {
            background: #fff3cd;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #ffc107;
            margin: 20px 0;
            line-height: 1.6;
        }

        .success-box {
            background: #d4edda;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #28a745;
            margin: 20px 0;
            line-height: 1.6;
        }

        .exam-controls {
            background: #f9f9f9;
            padding: 30px;
            border-radius: 15px;
            margin: 25px 0;
        }

        .timer-display {
            text-align: center;
            margin: 30px 0;
        }

        .timer {
            font-size: 4em;
            font-weight: bold;
            color: #667eea;
            font-family: 'Courier New', monospace;
            padding: 20px;
            background: white;
            border-radius: 15px;
            display: inline-block;
            min-width: 250px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .timer.warning {
            color: #ffc107;
            animation: pulse 1s infinite;
        }

        .timer.danger {
            color: #dc3545;
            animation: pulse 0.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .task-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 30px 0;
        }

        .task-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            border: 3px solid #ddd;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .task-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .task-card.active {
            border-color: #667eea;
            background: #e8eaf6;
        }

        .task-card h3 {
            color: #667eea;
            font-size: 1.8em;
            margin-bottom: 15px;
        }

        .task-card .duration {
            font-size: 1.2em;
            color: #666;
            margin: 10px 0;
        }

        .task-card .words {
            font-size: 1em;
            color: #999;
        }

        .writing-area {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 25px 0;
            border: 2px solid #ddd;
        }

        .writing-area h3 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .question-box {
            background: #f9f9f9;
            padding: 25px;
            border-radius: 10px;
            border-left: 5px solid #667eea;
            margin-bottom: 25px;
            line-height: 1.8;
        }

        .question-box img {
            max-width: 100%;
            height: auto;
            margin: 20px 0;
            border-radius: 10px;
        }

        textarea {
            width: 100%;
            min-height: 400px;
            padding: 20px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1.1em;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.8;
            resize: vertical;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .word-count-display {
            text-align: right;
            margin-top: 10px;
            font-size: 1.2em;
            color: #666;
        }

        .word-count-display.warning {
            color: #ffc107;
            font-weight: bold;
        }

        .word-count-display.success {
            color: #28a745;
            font-weight: bold;
        }

        .control-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .btn-warning {
            background: #ffc107;
            color: #000;
        }

        .btn-warning:hover {
            background: #e0a800;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-indicator.not-started {
            background: #6c757d;
        }

        .status-indicator.in-progress {
            background: #ffc107;
            animation: blink 1s infinite;
        }

        .status-indicator.completed {
            background: #28a745;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .progress-tracker {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            border: 2px solid #ddd;
        }

        .progress-tracker h3 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .progress-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: #f9f9f9;
            border-radius: 10px;
        }

        .progress-bar-container {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .checklist {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
        }

        .checklist-item {
            padding: 15px;
            margin: 10px 0;
            background: #f9f9f9;
            border-radius: 10px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .checklist-item:hover {
            background: #e8eaf6;
        }

        .checklist-item input[type="checkbox"] {
            width: 25px;
            height: 25px;
            margin-right: 15px;
            cursor: pointer;
        }

        .scoring-rubric {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 25px 0;
            border: 2px solid #ddd;
        }

        .criterion-card {
            background: #f9f9f9;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }

        .criterion-card h4 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .band-selector {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .band-option {
            padding: 10px 20px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
        }

        .band-option:hover {
            border-color: #667eea;
        }

        .band-option.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .tips-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .tip-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #ddd;
        }

        .tip-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .final-score {
            text-align: center;
            padding: 40px;
            background: #f9f9f9;
            border-radius: 15px;
            margin: 30px 0;
        }

        .final-score h3 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 20px;
        }

        .final-score .score {
            font-size: 5em;
            font-weight: bold;
            color: #667eea;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            .content {
                padding: 20px;
            }
            .task-selector {
                grid-template-columns: 1fr;
            }
            .timer {
                font-size: 2.5em;
            }
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>IELTS Writing Test - Full Exam Simulation</h1>
            <p>Lesson 18: Complete Practice Under Real Exam Conditions</p>
            <div class="nav-buttons">
                <a href="ielts_course_dashboard.html" class="nav-button">Back to Dashboard</a>
                <a href="ielts_lesson_17_timed_practice_2.html" class="nav-button">Previous Lesson</a>
                <a href="ielts_lesson_19_feedback_analysis.html" class="nav-button">Next Lesson</a>
            </div>
        </div>

        <div class="content">
            <!-- Navigation Tabs -->
            <div class="tabs">
                <button class="tab active" onclick="showTab('instructions')">Instructions</button>
                <button class="tab" onclick="showTab('exam')">Start Exam</button>
                <button class="tab" onclick="showTab('task1')">Task 1</button>
                <button class="tab" onclick="showTab('task2')">Task 2</button>
                <button class="tab" onclick="showTab('review')">Review & Score</button>
            </div>

            <!-- Tab 1: Instructions -->
            <div id="instructions" class="tab-content active">
                <div class="section">
                    <h2>Exam Instructions - Read Carefully</h2>

                    <div class="warning-box">
                        <strong>IMPORTANT: Real Exam Conditions</strong><br>
                        This is a FULL IELTS Writing test simulation. You must complete BOTH Task 1 and Task 2 in 60 minutes total. Once you start, treat this exactly like the real exam.
                    </div>

                    <div class="info-box">
                        <h3>What You Need:</h3>
                        <ul style="margin-left: 25px; margin-top: 10px; line-height: 1.8;">
                            <li>A quiet space with no distractions for 60 minutes</li>
                            <li>A timer (built into this simulator)</li>
                            <li>Full concentration and focus</li>
                            <li>Pen and paper for planning (recommended)</li>
                            <li>Water and anything you'd bring to the real exam</li>
                        </ul>
                    </div>

                    <div class="exam-controls">
                        <h3>Exam Structure:</h3>
                        
                        <div class="task-selector">
                            <div class="task-card">
                                <h3>Task 1</h3>
                                <p class="duration">20 minutes recommended</p>
                                <p class="words">Minimum 150 words</p>
                                <p style="margin-top: 15px; color: #666;">Describe a graph, chart, table, or diagram</p>
                            </div>

                            <div class="task-card">
                                <h3>Task 2</h3>
                                <p class="duration">40 minutes recommended</p>
                                <p class="words">Minimum 250 words</p>
                                <p style="margin-top: 15px; color: #666;">Write an essay responding to a question</p>
                            </div>
                        </div>
                    </div>

                    <div class="checklist">
                        <h3>Pre-Exam Checklist:</h3>
                        <div class="checklist-item">
                            <input type="checkbox" id="check1">
                            <label for="check1">I have 60 minutes of uninterrupted time</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="check2">
                            <label for="check2">I am in a quiet space with no distractions</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="check3">
                            <label for="check3">I have pen and paper for planning</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="check4">
                            <label for="check4">I understand the exam format and timing</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="check5">
                            <label for="check5">I am ready to treat this like the real exam</label>
                        </div>
                    </div>

                    <div class="tips-grid">
                        <div class="tip-card">
                            <h4>Time Management</h4>
                            <p>Task 1: 20 minutes (5 min planning, 15 min writing)</p>
                            <p>Task 2: 40 minutes (10 min planning, 30 min writing)</p>
                        </div>

                        <div class="tip-card">
                            <h4>Word Count</h4>
                            <p>Task 1: Aim for 170-180 words</p>
                            <p>Task 2: Aim for 270-290 words</p>
                        </div>

                        <div class="tip-card">
                            <h4>Planning is Essential</h4>
                            <p>Spend 5-10 minutes planning each task. This saves time and improves quality.</p>
                        </div>

                        <div class="tip-card">
                            <h4>Check Your Work</h4>
                            <p>Leave 2-3 minutes at the end to review for spelling and grammar errors.</p>
                        </div>
                    </div>

                    <div class="control-buttons">
                        <button class="btn btn-primary" onclick="startExam()">I'm Ready - Start Full Exam</button>
                    </div>
                </div>
            </div>

            <!-- Tab 2: Exam Start -->
            <div id="exam" class="tab-content">
                <div class="section">
                    <h2>Exam in Progress</h2>

                    <div class="timer-display">
                        <p style="font-size: 1.5em; margin-bottom: 20px;">Total Time Remaining</p>
                        <div class="timer" id="main-timer">60:00</div>
                    </div>

                    <div class="progress-tracker">
                        <h3>Your Progress</h3>
                        
                        <div class="progress-item">
                            <div>
                                <span class="status-indicator not-started" id="status-task1"></span>
                                <strong>Task 1:</strong> <span id="progress-task1">Not started</span>
                            </div>
                            <div>
                                <span id="words-task1">0 words</span>
                            </div>
                        </div>

                        <div class="progress-item">
                            <div>
                                <span class="status-indicator not-started" id="status-task2"></span>
                                <strong>Task 2:</strong> <span id="progress-task2">Not started</span>
                            </div>
                            <div>
                                <span id="words-task2">0 words</span>
                            </div>
                        </div>

                        <div class="progress-bar-container">
                            <div class="progress-bar-fill" id="overall-progress">0%</div>
                        </div>
                    </div>

                    <div class="control-buttons">
                        <button class="btn btn-primary" onclick="showTab('task1'); startTask(1);">Go to Task 1</button>
                        <button class="btn btn-primary" onclick="showTab('task2'); startTask(2);">Go to Task 2</button>
                        <button class="btn btn-warning" onclick="pauseTimer()">Pause Timer</button>
                        <button class="btn btn-success" onclick="resumeTimer()" disabled id="resume-btn">Resume Timer</button>
                    </div>

                    <div class="warning-box">
                        <strong>Exam Tips:</strong>
                        <ul style="margin-left: 25px; margin-top: 10px; line-height: 1.8;">
                            <li>Start with Task 1 (it's worth less, so don't spend too much time on it)</li>
                            <li>Watch the timer - don't spend more than 20 minutes on Task 1</li>
                            <li>If you finish early, use the time to check your work</li>
                            <li>You can switch between tasks using the tabs above</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Tab 3: Task 1 -->
            <div id="task1" class="tab-content">
                <div class="section">
                    <h2>Task 1 - Academic Writing</h2>

                    <div class="timer-display">
                        <p>Recommended Time: 20 minutes</p>
                        <div class="timer" id="task1-timer">20:00</div>
                    </div>

                    <div class="writing-area">
                        <h3>Task 1 Question</h3>
                        
                        <div class="question-box">
                            <p><strong>You should spend about 20 minutes on this task.</strong></p>
                            <br>
                            <p>The chart below shows the percentage of households in owned and rented accommodation in England and Wales between 1918 and 2011.</p>
                            <br>
                            <div style="background: #f0f0f0; padding: 40px; text-align: center; border-radius: 10px; margin: 20px 0;">
                                <p style="font-style: italic; color: #666;">[CHART: A line graph showing two lines from 1918 to 2011]</p>
                                <p style="margin-top: 20px; color: #999;">Line 1 (Blue): Households in owned accommodation - starts at ~25% (1918), crosses with rented line around 1971 at 50%, rises to ~70% (2011)</p>
                                <p style="color: #999;">Line 2 (Red): Households in rented accommodation - starts at ~75% (1918), crosses with owned line around 1971 at 50%, falls to ~30% (2011)</p>
                            </div>
                            <br>
                            <p><strong>Summarise the information by selecting and reporting the main features, and make comparisons where relevant.</strong></p>
                            <br>
                            <p>Write at least 150 words.</p>
                        </div>

                        <h3>Your Answer:</h3>
                        <textarea id="task1-text" placeholder="Write your Task 1 answer here...

Remember to:
- Write at least 150 words
- Describe the main trends and features
- Make relevant comparisons
- Use appropriate vocabulary for describing data
- Organize your answer clearly

You do not need to give your opinion for Task 1."></textarea>

                        <div class="word-count-display" id="task1-count">0 words (minimum 150)</div>
                    </div>

                    <div class="control-buttons">
                        <button class="btn btn-secondary" onclick="showTab('exam')">Back to Overview</button>
                        <button class="btn btn-primary" onclick="showTab('task2'); startTask(2);">Continue to Task 2</button>
                        <button class="btn btn-success" onclick="saveTask1()">Save Task 1</button>
                    </div>

                    <div class="info-box">
                        <h4>Task 1 Checklist:</h4>
                        <ul style="margin-left: 25px; margin-top: 10px; line-height: 1.8;">
                            <li>Have I written at least 150 words?</li>
                            <li>Did I describe the main trends/features?</li>
                            <li>Did I make relevant comparisons?</li>
                            <li>Is my answer well-organized with an introduction?</li>
                            <li>Did I use appropriate vocabulary for describing data?</li>
                            <li>Did I check for grammar and spelling errors?</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Tab 4: Task 2 -->
            <div id="task2" class="tab-content">
                <div class="section">
                    <h2>Task 2 - Essay Writing</h2>

                    <div class="timer-display">
                        <p>Recommended Time: 40 minutes</p>
                        <div class="timer" id="task2-timer">40:00</div>
                    </div>

                    <div class="writing-area">
                        <h3>Task 2 Question</h3>
                        
                        <div class="question-box">
                            <p><strong>You should spend about 40 minutes on this task.</strong></p>
                            <br>
                            <p><strong>Write about the following topic:</strong></p>
                            <br>
                            <p style="font-size: 1.15em; line-height: 1.8;">
                                Some people believe that professionals, such as doctors and engineers, should be required to work in the country where they did their training. Others believe they should be free to work in another country if they wish.
                            </p>
                            <br>
                            <p style="font-size: 1.15em;"><strong>Discuss both these views and give your own opinion.</strong></p>
                            <br>
                            <p><strong>Give reasons for your answer and include any relevant examples from your own knowledge or experience.</strong></p>
                            <br>
                            <p>Write at least 250 words.</p>
                        </div>

                        <h3>Your Answer:</h3>
                        <textarea id="task2-text" placeholder="Write your Task 2 essay here...

Remember to:
- Write at least 250 words
- Discuss BOTH views presented in the question
- Give YOUR opinion clearly
- Support your ideas with reasons and examples
- Organize your essay with clear paragraphs (introduction, body paragraphs, conclusion)
- Use linking words to connect your ideas"></textarea>

                        <div class="word-count-display" id="task2-count">0 words (minimum 250)</div>
                    </div>

                    <div class="control-buttons">
                        <button class="btn btn-secondary" onclick="showTab('task1')">Back to Task 1</button>
                        <button class="btn btn-secondary" onclick="showTab('exam')">Back to Overview</button>
                        <button class="btn btn-success" onclick="saveTask2()">Save Task 2</button>
                        <button class="btn btn-primary" onclick="finishExam()">Finish Exam</button>
                    </div>

                    <div class="info-box">
                        <h4>Task 2 Checklist:</h4>
                        <ul style="margin-left: 25px; margin-top: 10px; line-height: 1.8;">
                            <li>Have I written at least 250 words?</li>
                            <li>Did I discuss BOTH views mentioned in the question?</li>
                            <li>Did I give MY opinion clearly?</li>
                            <li>Is my essay well-organized with clear paragraphs?</li>
                            <li>Did I use examples to support my ideas?</li>
                            <li>Did I use linking words effectively?</li>
                            <li>Did I check for grammar and spelling errors?</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Tab 5: Review & Score -->
            <div id="review" class="tab-content">
                <div class="section">
                    <h2>Review Your Performance</h2>

                    <div class="success-box">
                        <strong>Exam Completed!</strong><br>
                        Take some time to review your work and assess your performance using the criteria below.
                    </div>

                    <div class="scoring-rubric">
                        <h3>Self-Assessment - Task 1</h3>
                        <p style="margin-bottom: 20px;">Rate your Task 1 performance on each criterion:</p>

                        <div class="criterion-card">
                            <h4>Task Achievement (TA)</h4>
                            <p style="margin-bottom: 15px;">Did you summarize the main features? Make relevant comparisons? Meet word count?</p>
                            <div class="band-selector">
                                <div class="band-option" onclick="selectBand(this, 'ta1', 5)">Band 5</div>
                                <div class="band-option" onclick="selectBand(this, 'ta1', 6)">Band 6</div>
                                <div class="band-option" onclick="selectBand(this, 'ta1', 7)">Band 7</div>
                                <div class="band-option" onclick="selectBand(this, 'ta1', 8)">Band 8</div>
                            </div>
                        </div>

                        <div class="criterion-card">
                            <h4>Coherence & Cohesion (CC)</h4>
                            <p style="margin-bottom: 15px;">Is your answer well-organized? Did you use linking words appropriately?</p>
                            <div class="band-selector">
                                <div class="band-option" onclick="selectBand(this, 'cc1', 5)">Band 5</div>
                                <div class="band-option" onclick="selectBand(this, 'cc1', 6)">Band 6</div>
                                <div class="band-option" onclick="selectBand(this, 'cc1', 7)">Band 7</div>
                                <div class="band-option" onclick="selectBand(this, 'cc1', 8)">Band 8</div>
                            </div>
                        </div>

                        <div class="criterion-card">
                            <h4>Lexical Resource (LR)</h4>
                            <p style="margin-bottom: 15px;">Did you use appropriate vocabulary for describing data? Any errors?</p>
                            <div class="band-selector">
                                <div class="band-option" onclick="selectBand(this, 'lr1', 5)">Band 5</div>
                                <div class="band-option" onclick="selectBand(this, 'lr1', 6)">Band 6</div>
                                <div class="band-option" onclick="selectBand(this, 'lr1', 7)">Band 7</div>
                                <div class="band-option" onclick="selectBand(this, 'lr1', 8)">Band 8</div>
                            </div>
                        </div>

                        <div class="criterion-card">
                            <h4>Grammatical Range & Accuracy (GRA)</h4>
                            <p style="margin-bottom: 15px;">Did you use a variety of structures? Were there many errors?</p>
                            <div class="band-selector">
                                <div class="band-option" onclick="selectBand(this, 'gra1', 5)">Band 5</div>
                                <div class="band-option" onclick="selectBand(this, 'gra1', 6)">Band 6</div>
                                <div class="band-option" onclick="selectBand(this, 'gra1', 7)">Band 7</div>
                                <div class="band-option" onclick="selectBand(this, 'gra1', 8)">Band 8</div>
                            </div>
                        </div>
                    </div>

                    <div class="scoring-rubric">
                        <h3>Self-Assessment - Task 2</h3>
                        <p style="margin-bottom: 20px;">Rate your Task 2 performance on each criterion:</p>

                        <div class="criterion-card">
                            <h4>Task Response (TR)</h4>
                            <p style="margin-bottom: 15px;">Did you address all parts? Discuss both views? Give your opinion? Use examples?</p>
                            <div class="band-selector">
                                <div class="band-option" onclick="selectBand(this, 'tr2', 5)">Band 5</div>
                                <div class="band-option" onclick="selectBand(this, 'tr2', 6)">Band 6</div>
                                <div class="band-option" onclick="selectBand(this, 'tr2', 7)">Band 7</div>
                                <div class="band-option" onclick="selectBand(this, 'tr2', 8)">Band 8</div>
                            </div>
                        </div>

                        <div class="criterion-card">
                            <h4>Coherence & Cohesion (CC)</h4>
                            <p style="margin-bottom: 15px;">Clear paragraphing? Good progression? Effective linking words?</p>
                            <div class="band-selector">
                                <div class="band-option" onclick="selectBand(this, 'cc2', 5)">Band 5</div>
                                <div class="band-option" onclick="selectBand(this, 'cc2', 6)">Band 6</div>
                                <div class="band-option" onclick="selectBand(this, 'cc2', 7)">Band 7</div>
                                <div class="band-option" onclick="selectBand(this, 'cc2', 8)">Band 8</div>
                            </div>
                        </div>

                        <div class="criterion-card">
                            <h4>Lexical Resource (LR)</h4>
                            <p style="margin-bottom: 15px;">Wide vocabulary range? Less common words? Collocations? Errors?</p>
                            <div class="band-selector">
                                <div class="band-option" onclick="selectBand(this, 'lr2', 5)">Band 5</div>
                                <div class="band-option" onclick="selectBand(this, 'lr2', 6)">Band 6</div>
                                <div class="band-option" onclick="selectBand(this, 'lr2', 7)">Band 7</div>
                                <div class="band-option" onclick="selectBand(this, 'lr2', 8)">Band 8</div>
                            </div>
                        </div>

                        <div class="criterion-card">
                            <h4>Grammatical Range & Accuracy (GRA)</h4>
                            <p style="margin-bottom: 15px;">Variety of structures? Complex sentences? Error-free sentences?</p>
                            <div class="band-selector">
                                <div class="band-option" onclick="selectBand(this, 'gra2', 5)">Band 5</div>
                                <div class="band-option" onclick="selectBand(this, 'gra2', 6)">Band 6</div>
                                <div class="band-option" onclick="selectBand(this, 'gra2', 7)">Band 7</div>
                                <div class="band-option" onclick="selectBand(this, 'gra2', 8)">Band 8</div>
                            </div>
                        </div>
                    </div>

                    <div class="control-buttons">
                        <button class="btn btn-primary" onclick="calculateScore()">Calculate My Overall Band Score</button>
                    </div>

                    <div id="score-result" class="hidden">
                        <div class="final-score">
                            <h3>Your Estimated Band Score</h3>
                            <div class="score" id="final-band">-</div>
                            <p style="font-size: 1.2em; color: #666; margin-top: 20px;">
                                Task 1 Average: <strong id="task1-avg">-</strong><br>
                                Task 2 Average: <strong id="task2-avg">-</strong><br>
                                Overall Writing Band: <strong id="overall-band">-</strong>
                            </p>
                        </div>

                        <div class="info-box">
                            <h3>Next Steps:</h3>
                            <ul style="margin-left: 25px; margin-top: 10px; line-height: 1.8;">
                                <li>Save your essays and review them tomorrow with fresh eyes</li>
                                <li>Identify specific areas for improvement based on your scores</li>
                                <li>Share your essays with your teacher for detailed feedback</li>
                                <li>Move on to Lesson 19 for in-depth feedback analysis techniques</li>
                                <li>Practice again with different question types</li>
                            </ul>
                        </div>

                        <div class="control-buttons">
                            <button class="btn btn-success" onclick="downloadEssays()">Download My Essays</button>
                            <button class="btn btn-primary" onclick="window.location.href='ielts_lesson_19_feedback_analysis.html'">Continue to Lesson 19</button>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // Global variables
        let totalSeconds = 3600; // 60 minutes
        let timerInterval;
        let isPaused = false;
        let task1Started = false;
        let task2Started = false;
        let examStarted = false;

        const scores = {
            ta1: 0, cc1: 0, lr1: 0, gra1: 0,
            tr2: 0, cc2: 0, lr2: 0, gra2: 0
        };

        // Tab switching
        function showTab(tabName) {
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));
            
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Start exam
        function startExam() {
            const checks = document.querySelectorAll('.checklist-item input[type="checkbox"]');
            let allChecked = true;
            checks.forEach(check => {
                if (!check.checked) allChecked = false;
            });

            if (!allChecked) {
                alert('Please complete the pre-exam checklist before starting!');
                return;
            }

            examStarted = true;
            showTab('exam');
            startMainTimer();
            
            // Show active tab
            const tabs = document.querySelectorAll('.tab');
            tabs[1].classList.add('active');
        }

        // Start main timer
        function startMainTimer() {
            timerInterval = setInterval(() => {
                if (!isPaused) {
                    totalSeconds--;
                    updateTimerDisplay();
                    
                    if (totalSeconds <= 0) {
                        clearInterval(timerInterval);
                        alert('Time is up! The exam has ended.');
                        finishExam();
                    }
                }
            }, 1000);
        }

        // Update timer display
        function updateTimerDisplay() {
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            const display = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            const timer = document.getElementById('main-timer');
            timer.textContent = display;
            
            // Change color based on time remaining
            if (totalSeconds <= 300) { // 5 minutes
                timer.className = 'timer danger';
            } else if (totalSeconds <= 600) { // 10 minutes
                timer.className = 'timer warning';
            } else {
                timer.className = 'timer';
            }
        }

        // Pause/Resume timer
        function pauseTimer() {
            isPaused = true;
            document.getElementById('resume-btn').disabled = false;
        }

        function resumeTimer() {
            isPaused = false;
            document.getElementById('resume-btn').disabled = true;
        }

        // Start task
        function startTask(taskNum) {
            if (taskNum === 1) {
                task1Started = true;
                document.getElementById('status-task1').className = 'status-indicator in-progress';
                document.getElementById('progress-task1').textContent = 'In progress';
            } else {
                task2Started = true;
                document.getElementById('status-task2').className = 'status-indicator in-progress';
                document.getElementById('progress-task2').textContent = 'In progress';
            }
            updateProgress();
        }

        // Word counting
        document.getElementById('task1-text')?.addEventListener('input', function() {
            const words = this.value.trim().split(/\s+/).filter(w => w.length > 0).length;
            const display = document.getElementById('task1-count');
            display.textContent = `${words} words (minimum 150)`;
            
            if (words < 150) {
                display.className = 'word-count-display';
            } else if (words < 170) {
                display.className = 'word-count-display warning';
            } else {
                display.className = 'word-count-display success';
            }
            
            document.getElementById('words-task1').textContent = `${words} words`;
            updateProgress();
        });

        document.getElementById('task2-text')?.addEventListener('input', function() {
            const words = this.value.trim().split(/\s+/).filter(w => w.length > 0).length;
            const display = document.getElementById('task2-count');
            display.textContent = `${words} words (minimum 250)`;
            
            if (words < 250) {
                display.className = 'word-count-display';
            } else if (words < 270) {
                display.className = 'word-count-display warning';
            } else {
                display.className = 'word-count-display success';
            }
            
            document.getElementById('words-task2').textContent = `${words} words`;
            updateProgress();
        });

        // Save tasks
        function saveTask1() {
            const text = document.getElementById('task1-text').value;
            if (text.trim().length === 0) {
                alert('Please write your Task 1 answer before saving!');
                return;
            }
            
            document.getElementById('status-task1').className = 'status-indicator completed';
            document.getElementById('progress-task1').textContent = 'Completed';
            alert('Task 1 saved! You can continue to Task 2 or review your answer.');
            updateProgress();
        }

        function saveTask2() {
            const text = document.getElementById('task2-text').value;
            if (text.trim().length === 0) {
                alert('Please write your Task 2 essay before saving!');
                return;
            }
            
            document.getElementById('status-task2').className = 'status-indicator completed';
            document.getElementById('progress-task2').textContent = 'Completed';
            alert('Task 2 saved! You can review your essay or finish the exam.');
            updateProgress();
        }

        // Update overall progress
        function updateProgress() {
            const task1Words = document.getElementById('task1-text').value.trim().split(/\s+/).filter(w => w.length > 0).length;
            const task2Words = document.getElementById('task2-text').value.trim().split(/\s+/).filter(w => w.length > 0).length;
            
            let progress = 0;
            if (task1Words >= 150) progress += 30;
            if (task2Words >= 250) progress += 70;
            
            const progressBar = document.getElementById('overall-progress');
            progressBar.style.width = `${progress}%`;
            progressBar.textContent = `${progress}%`;
        }

        // Finish exam
        function finishExam() {
            const task1Text = document.getElementById('task1-text').value.trim();
            const task2Text = document.getElementById('task2-text').value.trim();
            
            if (task1Text.length === 0 || task2Text.length === 0) {
                const proceed = confirm('You have not completed both tasks. Are you sure you want to finish?');
                if (!proceed) return;
            }
            
            clearInterval(timerInterval);
            showTab('review');
            
            // Show active tab
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            tabs[4].classList.add('active');
            
            alert('Exam finished! Please review your work and score yourself using the rubrics below.');
        }

        // Band selection
        function selectBand(element, criterion, band) {
            // Remove selection from siblings
            const siblings = element.parentElement.querySelectorAll('.band-option');
            siblings.forEach(sib => sib.classList.remove('selected'));
            
            // Select this option
            element.classList.add('selected');
            scores[criterion] = band;
        }

        // Calculate score
        function calculateScore() {
            // Check all scores are selected
            for (let key in scores) {
                if (scores[key] === 0) {
                    alert('Please select a band score for all criteria before calculating!');
                    return;
                }
            }
            
            // Calculate averages
            const task1Avg = (scores.ta1 + scores.cc1 + scores.lr1 + scores.gra1) / 4;
            const task2Avg = (scores.tr2 + scores.cc2 + scores.lr2 + scores.gra2) / 4;
            
            // Task 2 is worth twice as much as Task 1
            const overall = ((task1Avg * 1) + (task2Avg * 2)) / 3;
            
            // Round to nearest 0.5
            const rounded = Math.round(overall * 2) / 2;
            
            // Display results
            document.getElementById('task1-avg').textContent = task1Avg.toFixed(1);
            document.getElementById('task2-avg').textContent = task2Avg.toFixed(1);
            document.getElementById('overall-band').textContent = rounded.toFixed(1);
            document.getElementById('final-band').textContent = rounded.toFixed(1);
            
            document.getElementById('score-result').classList.remove('hidden');
            
            // Scroll to results
            document.getElementById('score-result').scrollIntoView({ behavior: 'smooth' });
        }

        // Download essays
        function downloadEssays() {
            const task1 = document.getElementById('task1-text').value;
            const task2 = document.getElementById('task2-text').value;
            
            const content = `IELTS WRITING TEST - MY ESSAYS
=====================================

TASK 1
------
${task1}

Word Count: ${task1.trim().split(/\s+/).filter(w => w.length > 0).length}


TASK 2
------
${task2}

Word Count: ${task2.trim().split(/\s+/).filter(w => w.length > 0).length}


SELF-ASSESSMENT SCORES
----------------------
Task 1:
- Task Achievement: Band ${scores.ta1}
- Coherence & Cohesion: Band ${scores.cc1}
- Lexical Resource: Band ${scores.lr1}
- Grammatical Range & Accuracy: Band ${scores.gra1}
- Average: ${((scores.ta1 + scores.cc1 + scores.lr1 + scores.gra1) / 4).toFixed(1)}

Task 2:
- Task Response: Band ${scores.tr2}
- Coherence & Cohesion: Band ${scores.cc2}
- Lexical Resource: Band ${scores.lr2}
- Grammatical Range & Accuracy: Band ${scores.gra2}
- Average: ${((scores.tr2 + scores.cc2 + scores.lr2 + scores.gra2) / 4).toFixed(1)}

Estimated Overall Band: ${document.getElementById('overall-band').textContent}`;
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'my_ielts_writing_test.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Initialize
        window.onload = function() {
            // Add event listener for beforeunload
            window.addEventListener('beforeunload', function(e) {
                if (examStarted && totalSeconds > 0) {
                    e.preventDefault();
                    e.returnValue = '';
                    return 'You are in the middle of an exam. Are you sure you want to leave?';
                }
            });
        };
    </script>
</body>
</html>
